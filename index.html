<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Waste CSI: Follow the Trash</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --bg-start: #060d0c;
      --bg-end: #0f1f1c;
      --card: rgba(15, 30, 28, 0.9);
      --border: rgba(52, 211, 153, 0.2);
      --green: #34d399;
      --red: #f87171;
      --yellow: #fbbf24;
    }
    body {
      background: radial-gradient(circle at center, var(--bg-end), var(--bg-start));
      color: #f3f4f6;
      font-family: 'Inter', system-ui, sans-serif;
    }
    .glass-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 24px;
      backdrop-filter: blur(12px);
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    }
    .item-box {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.1);
      cursor: grab;
      transition: all 0.2s ease;
    }
    .item-box:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-3px);
      border-color: var(--green);
    }
    .bin-box {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border-width: 2px;
    }
    .bin-box.drag-over {
      transform: scale(1.05);
      background: rgba(52, 211, 153, 0.1) !important;
      border-color: var(--green) !important;
    }
    .progress-fill {
      transition: width 0.7s cubic-bezier(0.65, 0, 0.35, 1);
    }
    .btn-action {
      background: linear-gradient(135deg, #10b981, #059669);
      transition: all 0.3s;
    }
    .btn-action:hover:not(:disabled) {
      filter: brightness(1.1);
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(5, 150, 105, 0.3);
    }
  </style>
</head>
<body class="min-h-screen p-6">
  <div class="max-w-6xl mx-auto space-y-12">

    <header class="text-center py-10">
      <h1 class="text-6xl font-black tracking-tighter mb-4 text-white">Waste CSI: <span class="text-emerald-500">Follow the Trash</span></h1>
      <p class="text-xl text-gray-400">Investigating Scope 3 emissions at ISS</p>
    </header>

    <section id="sorting-section" class="glass-card p-10">
      <div class="flex items-center gap-4 mb-8">
        <span class="text-3xl">üîç</span>
        <h2 class="text-3xl font-bold">Scene 1: The Waste Bin at Site</h2>
      </div>

      <div class="flex gap-4 mb-10">
        <button onclick="toggleBinStyle('old')" class="px-6 py-3 rounded-xl bg-gray-800 font-bold hover:bg-gray-700 transition">Old Inconsistent Bins</button>
        <button onclick="toggleBinStyle('standard')" class="px-6 py-3 rounded-xl bg-emerald-900/50 border border-emerald-500/50 font-bold hover:bg-emerald-800 transition">Standardised Bins</button>
      </div>

      <div class="bg-black/40 rounded-3xl p-8 mb-10 border border-white/5">
        <h3 class="text-xs uppercase font-black text-emerald-500 tracking-widest mb-6">üóëÔ∏è ISS Mixed Waste Bin (Unsorted)</h3>
        <div id="items" class="flex flex-wrap gap-4 justify-center min-h-[120px]">
          </div>
      </div>

      <div id="bins" class="grid grid-cols-1 sm:grid-cols-3 gap-8 mb-10">
        </div>

      <button onclick="activateSignage()" class="flex items-center gap-3 px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl transition mb-8 font-bold">
        <span>üñºÔ∏è</span> Activate Signage
      </button>

      <div id="feedback" class="p-6 bg-black/20 rounded-2xl text-center text-xl font-medium min-h-[80px] border border-white/5 text-gray-400 italic flex items-center justify-center">
        Analyze the trash and drag items to the correct bin...
      </div>

      <div class="mt-12 space-y-6">
        <div class="flex justify-between font-bold text-xl">
          <span>Contamination Level: <span id="contamination" class="text-emerald-400">0%</span></span>
          <span id="emissions-value" class="text-gray-400">+0 tCO‚ÇÇe extra emissions</span>
        </div>
        <div class="h-4 bg-black/50 rounded-full overflow-hidden border border-white/10">
          <div id="meter-bar" class="progress-fill w-0 h-full bg-gradient-to-r from-emerald-500 via-yellow-500 to-red-500"></div>
        </div>
      </div>

      <div class="flex justify-center gap-6 mt-16">
        <button id="nextBtn" disabled class="btn-action px-12 py-5 rounded-2xl text-2xl font-black text-white disabled:opacity-20 uppercase tracking-widest">
          Follow the Trash ‚Üí
        </button>
        <button onclick="location.reload()" class="px-10 py-5 bg-gray-800 rounded-2xl text-2xl font-bold hover:bg-gray-700 transition">Reset</button>
      </div>
    </section>

    <section id="journey-section" class="hidden glass-card p-10">
      <h2 class="text-4xl font-black mb-10 flex items-center gap-4"><span>üöö</span> Scene 2: Journey Analysis</h2>
      
      <div class="flex flex-wrap justify-center gap-12 items-center p-12 bg-black/30 rounded-3xl border border-white/5 mb-12">
        <div class="text-center"><div class="text-8xl mb-2">üóëÔ∏è</div><p class="font-black text-gray-500">BIN</p></div>
        <div class="text-4xl text-yellow-500">‚Üí</div>
        <div class="text-center"><div class="text-8xl mb-2">üöö</div><p class="font-black text-gray-500">TRUCK</p></div>
        <div class="text-4xl text-yellow-500">‚Üí</div>
        <div class="text-center"><div id="facility-icon" class="text-8xl mb-2">üî•</div><p id="facility-label" class="font-black text-gray-500 uppercase">Facility</p></div>
      </div>

      <div class="grid md:grid-cols-2 gap-8 mb-12">
        <div class="p-8 bg-black/40 rounded-2xl border border-white/5">
          <h3 class="text-2xl font-bold mb-4 text-yellow-500">Transport Investigation</h3>
          <p class="text-lg mb-6 text-gray-400">Current Contamination: <span id="contam-level" class="text-white font-bold">0%</span></p>
          <button onclick="simulateTransport()" class="w-full py-4 bg-yellow-600 font-black rounded-xl hover:bg-yellow-500 transition uppercase tracking-widest">Simulate Journey</button>
          <div id="transport-result" class="mt-6 text-lg min-h-[120px]"></div>
        </div>
        <div class="p-8 bg-black/40 rounded-2xl border border-white/5">
          <h3 class="text-2xl font-bold mb-4 text-emerald-500">Final Disposal</h3>
          <div id="disposal-result" class="text-lg min-h-[120px]">Waiting for simulation...</div>
        </div>
      </div>

      <div class="p-8 bg-black/20 rounded-2xl mb-12">
        <h3 class="text-xl font-bold mb-6 text-gray-500 uppercase tracking-widest">Sorting Report</h3>
        <ul id="outcome-list" class="space-y-4"></ul>
      </div>

      <div class="text-center">
        <div id="total-emissions" class="text-5xl font-black mb-12">Total Extra: +0 tCO‚ÇÇe</div>
        <button onclick="showImprovements()" class="btn-action px-12 py-6 rounded-2xl text-2xl font-black text-white uppercase tracking-widest">See After Improvements ‚Üí</button>
      </div>
    </section>

    <section id="improvements-section" class="hidden space-y-12">
      <div class="text-center">
        <h2 class="text-6xl font-black text-emerald-400 mb-4">Impact of Better Practices</h2>
        <p class="text-xl text-gray-400">Transforming the waste stream into a carbon asset.</p>
      </div>

      <div class="grid md:grid-cols-2 gap-8">
        <div class="glass-card p-12 text-center">
          <div id="reduction-display" class="text-9xl font-black text-emerald-500 opacity-0 transition-all duration-1000 scale-75">-205</div>
          <p class="text-2xl font-bold mt-4 uppercase">tCO‚ÇÇe Reduced Annually</p>
        </div>
        <div class="glass-card p-12 text-center">
          <div class="text-9xl font-black text-white">10%</div>
          <p class="text-2xl font-bold mt-4 uppercase">Target Contamination Rate</p>
        </div>
      </div>

      <div class="text-center">
        <button onclick="applyImprovements()" class="btn-action px-16 py-8 rounded-2xl text-3xl font-black text-white uppercase">Apply Changes & Show Impact</button>
      </div>

      <div class="grid md:grid-cols-4 gap-6">
        <div class="glass-card p-6 text-center bg-emerald-500/5">
          <div class="text-4xl mb-3">üìç</div>
          <h4 class="font-bold mb-2">Bin Standardisation</h4>
          <p class="text-xs text-gray-500">Uniform systems across sites.</p>
        </div>
        <div class="glass-card p-6 text-center bg-emerald-500/5">
          <div class="text-4xl mb-3">üñºÔ∏è</div>
          <h4 class="font-bold mb-2">Better Signage</h4>
          <p class="text-xs text-gray-500">Visual sorting guides.</p>
        </div>
        <div class="glass-card p-6 text-center bg-emerald-500/5">
          <div class="text-4xl mb-3">üçé</div>
          <h4 class="font-bold mb-2">Food Separation</h4>
          <p class="text-xs text-gray-500">Preventing organic methane.</p>
        </div>
        <div class="glass-card p-6 text-center bg-emerald-500/5">
          <div class="text-4xl mb-3">üìã</div>
          <h4 class="font-bold mb-2">Monthly Audits</h4>
          <p class="text-xs text-gray-500">KPI tracking and fixes.</p>
        </div>
      </div>
    </section>

  </div>

  <script>
    // YOUR ORIGINAL DATA
    const wasteItems = [
      { id: 1, name: "Food Scrap", icon: "üçé", emissions: 1.8, correctBin: "compost" },
      { id: 2, name: "Plastic Bottle", icon: "üõçÔ∏è", emissions: 0.9, correctBin: "recycling" },
      { id: 3, name: "Paper Cup", icon: "üìÑ", emissions: 0.4, correctBin: "recycling" },
      { id: 4, name: "Contaminated Mixed", icon: "üóëÔ∏è", emissions: 3.2, correctBin: "general" },
    ];

    const bins = [
      { id: "compost", name: "Compost üå±" },
      { id: "recycling", name: "Recycling ‚ôªÔ∏è" },
      { id: "general", name: "General üî•" },
    ];

    let sortedItems = [];
    let contamination = 0;
    let totalExtraEmissions = 0;
    let itemsLeft = wasteItems.length;
    let binStyle = "old";
    let signageActive = false;

    function $(id) { return document.getElementById(id); }

    function populateItems() {
      const cont = $("items");
      cont.innerHTML = "";
      wasteItems.forEach(item => {
        const el = document.createElement("div");
        el.className = "item-box px-8 py-5 rounded-2xl flex items-center gap-4 text-xl font-bold shadow-xl border border-white/10";
        el.draggable = true;
        el.dataset.id = item.id;
        el.innerHTML = `<span class="text-4xl">${item.icon}</span> ${item.name}`;
        el.addEventListener("dragstart", e => e.dataTransfer.setData("text/plain", item.id));
        cont.appendChild(el);
      });
    }

    function populateBins() {
      const cont = $("bins");
      cont.innerHTML = "";
      bins.forEach(bin => {
        const el = document.createElement("div");
        el.className = "bin-box p-12 rounded-3xl bg-black/40 text-center shadow-xl text-7xl font-bold border border-white/5";
        el.dataset.id = bin.id;
        el.innerHTML = bin.name.split(" ")[1] || "‚ôªÔ∏è";
        
        if (binStyle === "old") {
          el.style.backgroundColor = `hsl(${Math.random() * 360}, 20%, 20%)`;
        } else {
          el.style.borderColor = "rgba(16, 185, 129, 0.3)";
          el.style.backgroundColor = "rgba(16, 185, 129, 0.05)";
        }

        el.addEventListener("dragover", e => {
          e.preventDefault();
          el.classList.add("drag-over");
        });
        el.addEventListener("dragleave", () => el.classList.remove("drag-over"));
        el.addEventListener("drop", drop);
        cont.appendChild(el);
      });
    }

    function toggleBinStyle(style) {
      binStyle = style;
      populateBins();
      if (style === "standard") {
        contamination = Math.max(0, contamination - 10);
        updateUI();
      }
    }

    function activateSignage() {
      signageActive = true;
      contamination = Math.max(0, contamination - 10);
      updateUI();
      $("feedback").innerHTML = "<span class='text-emerald-400 font-bold'>Signage Active: Sorting intelligence increased!</span>";
    }

    function drop(e) {
      e.preventDefault();
      const binEl = e.currentTarget;
      binEl.classList.remove("drag-over");
      
      const id = parseInt(e.dataTransfer.getData("text/plain"));
      const item = wasteItems.find(i => i.id === id);
      const binId = binEl.dataset.id;
      
      let isCorrect = item.correctBin === binId;
      if (signageActive && !isCorrect) {
        isCorrect = Math.random() > 0.5;
      }

      document.querySelector(`[data-id="${id}"]`)?.remove();
      itemsLeft--;

      if (isCorrect) {
        binEl.style.borderColor = "#34d399";
        $("feedback").innerHTML = `<span class='text-emerald-400 font-bold'>Correct!</span> ${item.name} is handled properly.`;
      } else {
        binEl.style.borderColor = "#f87171";
        contamination = Math.min(100, contamination + 25);
        totalExtraEmissions += item.emissions;
        $("feedback").innerHTML = `<span class='text-red-400 font-bold'>Wrong!</span> ${item.name} contaminated the ${binId} bin.`;
      }

      sortedItems.push({ item, binId, isCorrect });
      updateUI();

      if (itemsLeft <= 0) {
        $("nextBtn").disabled = false;
        $("feedback").innerHTML = "<span class='text-yellow-400 font-bold uppercase'>All trash processed. Analyze the journey next!</span>";
      }
    }

    function updateUI() {
      $("contamination").textContent = contamination + "%";
      $("meter-bar").style.width = contamination + "%";
      $("emissions-value").textContent = `+${totalExtraEmissions.toFixed(1)} tCO‚ÇÇe extra emissions`;
    }

    $("nextBtn").onclick = () => {
      $("sorting-section").classList.add("hidden");
      $("journey-section").classList.remove("hidden");
      $("contam-level").textContent = contamination + "%";

      const list = $("outcome-list");
      list.innerHTML = sortedItems.map(s => `
        <li class="flex justify-between items-center p-4 border-b border-white/5 last:border-0">
          <div class="flex items-center gap-4"><span class="text-3xl">${s.item.icon}</span> <span>${s.item.name} ‚Üí ${s.binId}</span></div>
          <span class="font-bold ${s.isCorrect ? 'text-emerald-400' : 'text-red-400'}">${s.isCorrect ? '‚úì Clean' : '+' + s.item.emissions + ' tCO‚ÇÇe'}</span>
        </li>
      `).join("");

      $("total-emissions").textContent = `Total Extra: +${totalExtraEmissions.toFixed(1)} tCO‚ÇÇe`;
    };

    function simulateTransport() {
      const tr = $("transport-result");
      const dr = $("disposal-result");
      if (contamination > 30) {
        tr.innerHTML = "<p class='text-red-400 font-bold'>Inefficient Route</p><p>Extra haulage required due to contamination weight and rejection. <span class='text-white'>+0.8 tCO‚ÇÇe</span></p>";
        dr.innerHTML = "<p class='text-red-400 font-bold'>Load Rejected</p><p>Sent to incinerator. Recycling not possible.</p>";
        totalExtraEmissions += 3.3;
      } else {
        tr.innerHTML = "<p class='text-emerald-400 font-bold'>Optimized Route</p><p>Direct to processing facility. <span class='text-white'>+0.2 tCO‚ÇÇe</span></p>";
        dr.innerHTML = "<p class='text-emerald-400 font-bold'>Accepted</p><p>Materials sent for circular recovery.</p>";
        $("facility-icon").textContent = "‚ôªÔ∏è";
        $("facility-label").textContent = "Recycling Plant";
      }
      $("total-emissions").textContent = `Total Extra: +${totalExtraEmissions.toFixed(1)} tCO‚ÇÇe`;
    }

    function showImprovements() {
      $("journey-section").classList.add("hidden");
      $("improvements-section").classList.remove("hidden");
    }

    function applyImprovements() {
      const el = $("reduction-display");
      el.classList.replace("opacity-0", "opacity-100");
      el.classList.replace("scale-75", "scale-100");
    }

    // Initialize
    window.onload = () => {
      populateItems();
      populateBins();
    }
  </script>
</body>
</html>
